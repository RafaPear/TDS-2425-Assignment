<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>reversi-cli</title>
<link href="../images/logo-icon.svg" rel="icon" type="image/svg"><script>var pathToRoot = "../";</script>
    <script>document.documentElement.classList.replace("no-js", "js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
      if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
          document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
      } else {
        const savedDarkMode = JSON.parse(storage)
        if (savedDarkMode === true) {
          document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
      }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async></script>
<script type="text/javascript" src="../scripts/sourceset_dependencies.js" async></script>
<link href="../styles/style.css" rel="Stylesheet">
<link href="../styles/main.css" rel="Stylesheet">
<link href="../styles/prism.css" rel="Stylesheet">
<link href="../styles/logo-styles.css" rel="Stylesheet">
<link href="../ui-kit/ui-kit.min.css" rel="Stylesheet">
<script type="text/javascript" src="../scripts/safe-local-storage_blocking.js"></script>
<script type="text/javascript" src="../scripts/navigation-loader.js" async></script>
<script type="text/javascript" src="../scripts/platform-content-handler.js" async></script>
<script type="text/javascript" src="../scripts/main.js" defer></script>
<script type="text/javascript" src="../scripts/prism.js" async></script>
<script type="text/javascript" src="../ui-kit/ui-kit.min.js" defer></script></head>
<body>
<div class="root">
    <header class="navigation theme-dark" id="navigation-wrapper" role="banner">
<a class="library-name--link" href="../index.html" tabindex="1">
                    reversi
            </a>        <button class="navigation-controls--btn navigation-controls--btn_toc ui-kit_mobile-only" id="toc-toggle" type="button">Toggle table of contents
        </button>
        <div class="navigation-controls--break ui-kit_mobile-only"></div>
        <div class="library-version" id="library-version">2.0.0
        </div>
        <div class="navigation-controls">
        <ul class="filter-section filter-section_loading" id="filter-section" aria-label="Target filter">
                <button class="platform-tag platform-selector jvm-like" data-active="" aria-pressed="true" data-filter=":reversi-cli/main">jvm</button>
            <div class="dropdown filter-section--dropdown" data-role="dropdown" id="filter-section-dropdown">
                <button class="button button_dropdown filter-section--dropdown-toggle" role="combobox" data-role="dropdown-toggle" aria-controls="platform-tags-listbox" aria-haspopup="listbox" aria-expanded="false" aria-label="Toggle source sets"></button>
                <ul role="listbox" id="platform-tags-listbox" class="dropdown--list" data-role="dropdown-listbox" aria-label="Target filter">
                    <div class="dropdown--header"><span>Target filter</span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close target filter">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                        <li role="option" class="dropdown--option platform-selector-option jvm-like" tabindex="0">
                            <label class="checkbox">
                                <input type="checkbox" class="checkbox--input" id=":reversi-cli/main" data-filter=":reversi-cli/main">
                                <span class="checkbox--icon"></span>
                                jvm
                            </label>
                        </li>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </ul>
            <button class="navigation-controls--btn navigation-controls--btn_theme" id="theme-toggle-button" type="button">Switch theme
            </button>
            <div class="navigation-controls--btn navigation-controls--btn_search" id="searchBar" role="button">Search in
                API
            </div>
        </div>
    </header>
    <div id="container">
        <nav id="leftColumn" class="sidebar" data-item-type="SECTION" data-item-config="{&quot;defaultSize&quot;: 280, &quot;minSize&quot;: 200, &quot;maxSize&quot;: 400}">
            <a class="toc--skip-link" href="#main">Skip to content</a>
            <div class="dropdown theme-dark_mobile" data-role="dropdown" id="toc-dropdown">
                <ul role="listbox" id="toc-listbox" class="dropdown--list dropdown--list_toc-list" data-role="dropdown-listbox" aria-label="Table of contents">
                    <div class="dropdown--header">
                            <span>
                                    reversi
                            </span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close table of contents">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                    <div class="sidebar--inner" id="sideMenu"></div>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </nav>
        <div id="resizer" class="resizer" data-item-type="BAR"></div>
        <div id="main" data-item-type="SECTION" role="main">
<div class="main-content" id="content" pageids="reversi-cli::////PointingToDeclaration//968266343">
  <div class="breadcrumbs"></div>
  <div class="cover ">
    <h1 class="cover"><span><span>reversi-cli</span></span></h1>
    <div class="platform-hinted UnderCoverText" data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":reversi-cli/main"><h2 class="">Overview</h2><p class="paragraph">A scriptable, interactive command-line interface for playing Reversi. The CLI is designed to be minimal, event-driven, and testable. It uses the KtFlag library for compact command parsing and provides a read-eval-print loop (REPL) that manages game context and command execution.</p><p class="paragraph">The CLI is stateful, maintaining the current game in memory and coordinating with the storage module to load and save games. It separates presentation logic (rendering the board) from command logic (executing moves), making it easy to test individual commands.</p><p class="paragraph"><img alt="Reversi App Screenshot" src="../images/UML_Structure_CLI.png"></p><h2 class="">Architecture</h2><p class="paragraph">The module is organized into two main packages:</p><ul><li><p class="paragraph"><strong>Main CLI Package</strong> — CLI coordinator, command parsing, and rendering</p></li><li><p class="paragraph"><strong>Commands Package</strong> — Individual command implementations</p></li></ul><h3 class="">CLI Coordinator (CLI.kt)</h3><p class="paragraph">The main loop that:</p><ol><li><p class="paragraph">Displays a welcome message</p></li><li><p class="paragraph">Creates a command parser with all registered commands</p></li><li><p class="paragraph">Repeatedly reads input and dispatches to the parser</p></li><li><p class="paragraph">Maintains the current Game context across iterations</p></li><li><p class="paragraph">Displays command results to the user</p></li></ol><p class="paragraph">The CLI uses KtFlag's CommandParser for flexible argument parsing and colored output.</p><h3 class="">Command Pattern</h3><p class="paragraph">All commands extend <code class="lang-kotlin">CommandImpl&lt;Game&gt;</code> and provide:</p><ul><li><p class="paragraph"><code class="lang-kotlin">CommandInfo</code> metadata (title, description, aliases, usage)</p></li><li><p class="paragraph">An <code class="lang-kotlin">execute()</code> method that takes arguments and a game context</p></li><li><p class="paragraph">A return value indicating success/failure and the new game state</p></li></ul><p class="paragraph">This design allows commands to be:</p><ul><li><p class="paragraph">Tested independently</p></li><li><p class="paragraph">Added/removed dynamically</p></li><li><p class="paragraph">Configured with different parameters</p></li><li><p class="paragraph">Composed with other commands</p></li></ul><h2 class="">Commands</h2><h3 class="">Game Management</h3><ul><li><p class="paragraph"><strong>NewCmd (n)</strong> — Creates a new game with specified first player (# or @)</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">new # [name]</code></p></li><li><p class="paragraph">Optional name saves game to persistent storage</p></li><li><p class="paragraph">Saves previous game before creating new one</p></li></ul><li><p class="paragraph"><strong>JoinCmd (j)</strong> — Joins an existing saved game</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">join &lt;name&gt; [#|@]</code></p></li><li><p class="paragraph">Loads game from storage by name</p></li><li><p class="paragraph">Optional piece type specifies which side you control</p></li><li><p class="paragraph">Useful for multi-player or turn-based scenarios</p></li></ul></ul><h3 class="">Gameplay</h3><ul><li><p class="paragraph"><strong>PlayCmd (p)</strong> — Executes a move at specified coordinates</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">play (row) (col)</code> or <code class="lang-kotlin">play (rowcol)</code></p></li><li><p class="paragraph">Supports multiple coordinate formats:</p></li><ul><li><p class="paragraph"><code class="lang-kotlin">play 3 4</code> (two separate arguments)</p></li><li><p class="paragraph"><code class="lang-kotlin">play 3A</code> (row + letter column)</p></li><li><p class="paragraph"><code class="lang-kotlin">play 34</code> (row + digit column)</p></li></ul><li><p class="paragraph">Validates move legality before executing</p></li><li><p class="paragraph">Displays updated board after move</p></li></ul><li><p class="paragraph"><strong>PassCmd</strong> — Passes turn when no legal moves available</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">pass</code></p></li><li><p class="paragraph">Checks that player actually has no legal moves</p></li><li><p class="paragraph">Counts consecutive passes; ends game after two</p></li><li><p class="paragraph">Announces winner if game ends</p></li></ul></ul><h3 class="">Game Viewing</h3><ul><li><p class="paragraph"><strong>ShowCmd (s)</strong> — Displays current board and game state</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">show</code></p></li><li><p class="paragraph">Shows ASCII board with piece positions</p></li><li><p class="paragraph">Displays both players' scores</p></li><li><p class="paragraph">Indicates current turn</p></li><li><p class="paragraph">Shows game name if applicable</p></li></ul><li><p class="paragraph"><strong>RefreshCmd (r)</strong> — Reloads game state from storage</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">refresh</code></p></li><li><p class="paragraph">Useful in multi-process scenarios where another instance might have updated the game</p></li><li><p class="paragraph">Reloads from storage and redisplays board</p></li></ul></ul><h3 class="">Game Control</h3><ul><li><p class="paragraph"><strong>TargetCmd</strong> — Toggles target mode for visual feedback</p></li><ul><li><p class="paragraph">Syntax: <code class="lang-kotlin">target [true|false|yes|no|1|0|on|off]</code></p></li><li><p class="paragraph">Enables/disables highlighting of available moves</p></li><li><p class="paragraph">Supports various boolean representations</p></li></ul><li><p class="paragraph"><strong>ExitCmd (exit, quit, q)</strong> — Terminates the application</p></li><ul><li><p class="paragraph">Prompts to save current game before exit if needed</p></li><li><p class="paragraph">Persists game state to storage</p></li><li><p class="paragraph">Closes any open resources</p></li></ul></ul><h3 class="">Debug Commands (--debug flag)</h3><ul><li><p class="paragraph"><strong>DebugCmd (dbg)</strong> — Displays detailed internal state</p></li><ul><li><p class="paragraph">Shows board representation</p></li><li><p class="paragraph">Lists player information</p></li><li><p class="paragraph">Displays configuration values</p></li><li><p class="paragraph">Lists saved games in storage folder</p></li></ul><li><p class="paragraph"><strong>ListGamesCmd (lg)</strong> — Lists all saved games</p></li><ul><li><p class="paragraph">Shows files in the saves directory</p></li><li><p class="paragraph">Helpful for testing and debugging</p></li></ul></ul><h2 class="">Configuration</h2><p class="paragraph">The CLI reads configuration from <code class="lang-kotlin">reversi-cli.properties</code>:</p><ul><li><p class="paragraph"><code class="lang-kotlin">WELCOME_MESSAGE</code> — Message shown at startup</p></li><li><p class="paragraph"><code class="lang-kotlin">PROMPT</code> — Command prompt symbol</p></li><li><p class="paragraph">Color configuration (<code class="lang-kotlin">PROMPT_COLOR</code>, <code class="lang-kotlin">TEXT_COLOR</code>, <code class="lang-kotlin">ERROR_COLOR</code>, etc.)</p></li></ul><p class="paragraph">Colors can be customized to match terminal capabilities.</p><h2 class="">Command Execution Flow</h2><ol><li><p class="paragraph">User types command with arguments</p></li><li><p class="paragraph">Parser matches against registered commands</p></li><li><p class="paragraph">Command's execute() is called with arguments and current Game context</p></li><li><p class="paragraph">Command validates input and executes business logic</p></li><li><p class="paragraph">Command returns CommandResult with success/failure and new game state</p></li><li><p class="paragraph">CLI displays the result message</p></li><li><p class="paragraph">CLI updates its game context if game changed</p></li></ol><h2 class="">Integration</h2><p class="paragraph">The CLI integrates with:</p><ul><li><p class="paragraph"><strong>reversi-core</strong> — Game logic and types</p></li><li><p class="paragraph"><strong>reversi-storage</strong> — Persistence (loading and saving games)</p></li><li><p class="paragraph"><strong>reversi-utils</strong> — Configuration loading and utilities</p></li><li><p class="paragraph"><strong>KtFlag</strong> — Command parsing and rendering</p></li></ul><p class="paragraph">The CLI is intentionally thin, delegating all business logic to the core and storage modules.</p><h2 class="">Error Handling</h2><p class="paragraph">Commands provide user-friendly error messages:</p><ul><li><p class="paragraph">"Game is not defined" — When operations require a game but none is active</p></li><li><p class="paragraph">"Invalid coordinates provided" — For malformed move syntax</p></li><li><p class="paragraph">"It's not your turn" — For networked games</p></li><li><p class="paragraph">"There are available plays, cannot pass" — For illegal pass attempts</p></li></ul><p class="paragraph">These messages help users understand what went wrong and how to fix it.</p><h2 class="">Testing</h2><p class="paragraph">Commands are designed to be testable:</p><ul><li><p class="paragraph">Each command can be tested independently with mock Game objects</p></li><li><p class="paragraph">Command parsing can be tested without I/O</p></li><li><p class="paragraph">Output rendering can be captured and verified</p></li><li><p class="paragraph">Integration tests can simulate user input sequences</p></li></ul></div></div>
  </div>
  <h2 class="">Packages</h2>
  <div class="table"><a data-name="-1304438201%2FPackages%2F968266343" anchor-label="pt.isel.reversi.cli" id="-1304438201%2FPackages%2F968266343" data-filterable-set=":reversi-cli/main"></a>
    <div class="table-row table-row_platform-tagged" data-filterable-current=":reversi-cli/main" data-filterable-set=":reversi-cli/main">
      <div>
        <div class="main-subrow ">
          <div class=""><span class="inline-flex">
              <div><a href="pt.isel.reversi.cli/index.html">pt.isel.reversi.cli</a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1304438201%2FPackages%2F968266343"></span>
                <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
              </span></span></div>
          <div class="pull-right platform-tags--wrapper">
            <div class="platform-tags no-gutters">
              <div class="platform-tag jvm-like">jvm</div>
            </div>
          </div>
        </div>
        <div><span class="brief-comment"><a data-name="-1304438201%2FPackages%2F968266343" anchor-label="pt.isel.reversi.cli" id="-1304438201%2FPackages%2F968266343" data-filterable-set=":reversi-cli/main"></a>
            <p class="paragraph">Hosts the CLI loop, command parsing and rendering utilities. The CLI is designed to be minimal and driven by plain standard input/output which makes it easy to script and test.</p>
          </span></div>
      </div>
    </div>
<a data-name="-130744749%2FPackages%2F968266343" anchor-label="pt.isel.reversi.cli.commands" id="-130744749%2FPackages%2F968266343" data-filterable-set=":reversi-cli/main"></a>
    <div class="table-row table-row_platform-tagged" data-filterable-current=":reversi-cli/main" data-filterable-set=":reversi-cli/main">
      <div>
        <div class="main-subrow ">
          <div class=""><span class="inline-flex">
              <div><a href="pt.isel.reversi.cli.commands/index.html">pt.isel.reversi.cli.commands</a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-130744749%2FPackages%2F968266343"></span>
                <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
              </span></span></div>
          <div class="pull-right platform-tags--wrapper">
            <div class="platform-tags no-gutters">
              <div class="platform-tag jvm-like">jvm</div>
            </div>
          </div>
        </div>
        <div><span class="brief-comment"><a data-name="-130744749%2FPackages%2F968266343" anchor-label="pt.isel.reversi.cli.commands" id="-130744749%2FPackages%2F968266343" data-filterable-set=":reversi-cli/main"></a>
            <p class="paragraph">Contains concrete command handlers used by the CLI. Each command is implemented as an object extending the <code class="lang-kotlin">CommandImpl&lt;Game&gt;</code> contract provided by <code class="lang-kotlin">KtFlag</code>.</p>
          </span></div>
      </div>
    </div>
  </div>
</div>
    <div class="footer">
        <div class="footer--container">
            <a href="#content" id="go-to-top-link" class="footer--button footer--button_go-to-top"></a>
            <div class="footer--content">
                <div>
                    <span>Generated by </span>
                    <a class="footer--link footer--link_external" href="https://github.com/Kotlin/dokka">
                        Dokka
                    </a>
                    <div>2025 ISEL - TDS</div>
                </div>
            </div>
        </div>
    </div>
        </div>
    </div>
</div>
</body>
</html>